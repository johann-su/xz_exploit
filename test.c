/* Function pointer for the implementation of the 'crc64' function */
typedef uint64_t (*crc64_func_type)(
    const uint8_t *buf, size_t size, uint64_t crc);

/*
 * Function prototype for the 'crc64' function
 * Attribute marks 'crc64_resolve' as the resolver function to pick an implementation
 */
uint64_t lzma_crc64(const uint8_t *buf, size_t size, uint64_t crc)
    __attribute__((__ifunc__("crc64_resolve")));

/* Function to resolve the implementation of crc64 at runtime */
static crc64_func_type crc64_resolve(void)
{
    return is_clmul_supported() ? &crc64_clmul : &crc64_generic;
}